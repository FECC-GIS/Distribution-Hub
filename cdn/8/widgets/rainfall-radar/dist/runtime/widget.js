System.register(["jimu-core/emotion","jimu-core","jimu-arcgis","esri/layers/WebTileLayer","esri/core/reactiveUtils","jimu-ui","calcite-components","jimu-core/react"],function(f,e){var t={},r={},a={},n={},i={},o={},c={},s={};return{setters:[function(f){t.jsx=f.jsx,t.jsxs=f.jsxs},function(f){r.React=f.React,r.ReactRedux=f.ReactRedux,r.getAppStore=f.getAppStore},function(f){a.JimuMapViewComponent=f.JimuMapViewComponent},function(f){n.default=f.default},function(f){i.default=f.default},function(f){o.Alert=f.Alert,o.Loading=f.Loading,o.Slider=f.Slider},function(f){c.CalciteButton=f.CalciteButton},function(f){s.useEffect=f.useEffect}],execute:function(){f((()=>{var f={37:f=>{"use strict";f.exports=c},56:(f,e,t)=>{"use strict";f.exports=function(f){var e=t.nc;e&&f.setAttribute("nonce",e)}},72:f=>{"use strict";var e=[];function t(f){for(var t=-1,r=0;r<e.length;r++)if(e[r].identifier===f){t=r;break}return t}function r(f,r){for(var n={},i=[],o=0;o<f.length;o++){var c=f[o],s=r.base?c[0]+r.base:c[0],l=n[s]||0,d="".concat(s," ").concat(l);n[s]=l+1;var u=t(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)e[u].references++,e[u].updater(p);else{var m=a(p,r);r.byIndex=o,e.splice(o,0,{identifier:d,updater:m,references:1})}i.push(d)}return i}function a(f,e){var t=e.domAPI(e);t.update(f);return function(e){if(e){if(e.css===f.css&&e.media===f.media&&e.sourceMap===f.sourceMap&&e.supports===f.supports&&e.layer===f.layer)return;t.update(f=e)}else t.remove()}}f.exports=function(f,a){var n=r(f=f||[],a=a||{});return function(f){f=f||[];for(var i=0;i<n.length;i++){var o=t(n[i]);e[o].references--}for(var c=r(f,a),s=0;s<n.length;s++){var l=t(n[s]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}n=c}}},113:f=>{"use strict";f.exports=function(f,e){if(e.styleSheet)e.styleSheet.cssText=f;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(f))}}},243:f=>{"use strict";f.exports=i},244:f=>{"use strict";f.exports=r},314:f=>{"use strict";f.exports=function(f){var e=[];return e.toString=function(){return this.map(function(e){var t="",r=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),r&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=f(e),r&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t}).join("")},e.i=function(f,t,r,a,n){"string"==typeof f&&(f=[[null,f,void 0]]);var i={};if(r)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(i[c]=!0)}for(var s=0;s<f.length;s++){var l=[].concat(f[s]);r&&i[l[0]]||(void 0!==n&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=n),t&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=t):l[2]=t),a&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=a):l[4]="".concat(a)),e.push(l))}},e}},321:f=>{"use strict";f.exports=o},386:f=>{"use strict";f.exports=t},493:f=>{"use strict";f.exports=n},540:f=>{"use strict";f.exports=function(f){var e=document.createElement("style");return f.setAttributes(e,f.attributes),f.insert(e,f.options),e}},601:f=>{"use strict";f.exports=function(f){return f[1]}},659:f=>{"use strict";var e={};f.exports=function(f,t){var r=function(f){if(void 0===e[f]){var t=document.querySelector(f);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(f){t=null}e[f]=t}return e[f]}(f);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},686:f=>{"use strict";f.exports=a},761:(f,e,t)=>{"use strict";t.d(e,{A:()=>o});var r=t(601),a=t.n(r),n=t(314),i=t.n(n)()(a());i.push([f.id,".date-grid{display:grid;grid-template-columns:45px 137px 45px;column-gap:16px;background-color:white;padding:5px 16px 12px}.text-slide-div{margin-bottom:8px}.text-div{display:grid;grid-template-columns:97px 40px;padding:0;margin-bottom:3px;height:25px}.label-text{margin:0;align-self:end}.date-text{font-size:12px;font-weight:900}.now-text{font-size:x-small}.time-slider{margin:0;background:linear-gradient(var(--calcite-ui-border-input), var(--calcite-ui-border-input));background-size:3px 110%;background-repeat:no-repeat;background-position:105px}.play-button{justify-self:center;align-self:flex-end}input[type=range].time-slider::-webkit-slider-runnable-track{height:5px;border-radius:20px}input[type=range].time-slider::-webkit-slider-thumb{margin-top:-5px}input[type=range].time-slider::-moz-range-track{height:5px;border-radius:20px}input[type=range].time-slider::-moz-range-thumb{margin-top:-5px}",""]);const o=i},825:f=>{"use strict";f.exports=function(f){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=f.insertStyleElement(f);return{update:function(t){!function(f,e,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var a=void 0!==t.layer;a&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,a&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var n=t.sourceMap;n&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleTagTransform(r,f,e.options)}(e,f,t)},remove:function(){!function(f){if(null===f.parentNode)return!1;f.parentNode.removeChild(f)}(e)}}}},903:(f,e,t)=>{"use strict";t.d(e,{A:()=>o});var r=t(601),a=t.n(r),n=t(314),i=t.n(n)()(a());i.push([f.id,".table-color{width:100%;height:100%;align-self:end}.color-grid{display:grid;grid-template-columns:40px 205px 40px;column-gap:3px;margin-bottom:10px}.color-dropdown{overflow-y:scroll;height:500px}.color-dropdown-item:hover{background:rgba(0, 127, 148, 0.2) !important}.div-dropdown-item{width:100%;z-index:-99}.main-grid{display:grid;grid-template-columns:292px;margin-bottom:30px;column-gap:5px}",""]);const o=i},972:f=>{"use strict";f.exports=s}},e={};function l(t){var r=e[t];if(void 0!==r)return r.exports;var a=e[t]={id:t,exports:{}};return f[t](a,a.exports,l),a.exports}l.n=f=>{var e=f&&f.__esModule?()=>f.default:()=>f;return l.d(e,{a:e}),e},l.d=(f,e)=>{for(var t in e)l.o(e,t)&&!l.o(f,t)&&Object.defineProperty(f,t,{enumerable:!0,get:e[t]})},l.o=(f,e)=>Object.prototype.hasOwnProperty.call(f,e),l.r=f=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})},l.p="",l.nc=void 0;var d={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(d),l.d(d,{__set_webpack_public_path__:()=>J,default:()=>H});var f=l(386),e=l(244),t=l(686),r=l(493),a=l(243),n=l(321);const i={1:["#dfdfdfff","#9bea8fff","#58ff42ff","#47c278ff","#4793f9ff","#0c59ffff","#6153c1ff","#ff93a3ff","#ff3f35ff","#c20511ff","#ffeb0aff","#ff9811ff","#a84c06ff","#dda8ffff","#ffffffff"],2:["#79746044","#92887188","#cec087cc","#88ddeeff","#0099ccff","#0077aaff","#005588ff","#ffee00ff","#ffaa00ff","#ff7700ff","#ff4400ff","#ee0000ff","#ffaaffff","#ff44ffff","#ff00ffff","#aa00aaff"],3:["#353535ff","#757575ff","#005a00ff","#007e00ff","#087fdbff","#1c47e8ff","#6e0dc6ff","#c80f86ff","#c06487ff","#d2883bff","#fac431ff","#fefb02ff","#fe9a58ff","#fe5f05ff","#fd341cff","#bebebeff"],4:["#01b714ff","#088915ff","#0c7617ff","#007e00ff","#106218ff","#074407ff","#3b6707ff","#859a07ff","#ffee07ff","#f7b708ff","#f38b08ff","#ef7008ff","#ea5e09ff","#e95d09ff","#df370aff","#dc2e0aff"],5:["#3ffefcff","#1790f9ff","#0000f3ff","#41ff50ff","#32c23dff","#4b8339ff","#ffff50ff","#fdbb3cff","#df5e0bff","#fd8788ff","#e90000ff","#a80000ff","#ef5beeff","#924cbeff","#502a68ff"],6:["#04e9e7ff","#00efe7ff","#009cf7ff","#0000f7ff","#00ff00ff","#03b703ff","#087305ff","#ffff00ff","#ecce00ff","#fe9300ff","#ff0000ff","#bd0000ff","#fe00feff","#9c52c6ff","#fefefeff","#ffffffff"],7:["#009f9fff","#009047ff","#00b031ff","#00ff00ff","#00d319ff","#10e81dff","#92fd1eff","#fffd1bff","#ffd400ff","#ffab00ff","#fe6d00ff","#ef0f02ff","#d00523ff","#e503b5ff","#ff66ffff","#ffaaffff"],8:["#005eb617","#005eb628","#005eb639","#005eb64e","#005eb670","#075cb4a6","#1c59b0cf","#3955abe3","#6350a3f1","#8e4b9bff","#d04f81ff","#fc676fff","#fd8f6eff","#ffb76eff","#ffe12eff","#fffd05ff"]},o={1:["#efffffff","#dfffffff","#cfffffff","#bfffffff","#afffffff","#9fffffff","#8fffffff","#7fefffff","#6fdfffff","#5fcfffff","#4fafffff","#3f9fffff","#2f8fffff","#1f7fffff","#0f6fffff","#005fffff","#004fffff","#003fffff","#002fffff","#001fffff","#000fffff"],2:["#efffffff","#dfffffff","#cfffffff","#bfffffff","#afffffff","#9fffffff","#bfffffff","#9fdfffff","#7fbfffff","#5f9fffff","#4f8fffff","#3f7fffff","#2f6fffff","#1f5fffff","#002fffff","#001fffff","#000fffff"],3:["#efffffff","#dfffffff","#cfffffff","#bfffffff","#afffffff","#9fffffff","#8fffffff","#7fefffff","#6fdfffff","#5fcfffff","#4fafffff","#3f9fffff","#2f8fffff","#1f7fffff","#0f6fffff","#005fffff","#004fffff","#003fffff","#002fffff","#001fffff","#000fffff"],4:["#efffffff","#dfffffff","#cfffffff","#bfffffff","#afffffff","#9fffffff","#8fffffff","#7fefffff","#6fdfffff","#5fcfffff","#4fafffff","#3f9fffff","#2f8fffff","#1f7fffff","#0f6fffff","#005fffff","#004fffff","#003fffff","#002fffff","#001fffff","#000fffff"],5:["#3ffefcff","#1790f9ff","#0000f3ff","#41ff50ff","#32c23dff","#4b8339ff","#ffff50ff","#fdbb3cff","#df5e0bff","#fd8788ff","#e90000ff","#a80000ff","#ef5beeff","#924cbeff","#502a68ff"],6:["#e5fefeff","#a3f3ffff","#51cffdff","#0d99fcff","#0f75fbff","#1053fbff","#0b32cfff","#0726a4ff","#031875ff","#010940ff"],7:["#efffffff","#dfffffff","#cfffffff","#bfffffff","#afffffff","#9fffffff","#8fffffff","#7fefffff","#6fdfffff","#5fcfffff","#4fafffff","#3f9fffff","#2f8fffff","#1f7fffff","#0f6fffff","#005fffff","#004fffff","#003fffff","#002fffff","#001fffff","#000fffff"],8:["#efffffff","#dfffffff","#cfffffff","#bfffffff","#afffffff","#9fffffff","#8fffffff","#7fefffff","#6fdfffff","#5fcfffff","#4fafffff","#3f9fffff","#2f8fffff","#1f7fffff","#0f6fffff","#005fffff","#004fffff","#003fffff","#002fffff","#001fffff","#000fffff"]};var c=l(72),s=l.n(c),u=l(825),p=l.n(u),m=l(659),g=l.n(m),h=l(56),b=l.n(h),v=l(540),x=l.n(v),y=l(113),w=l.n(y),j=l(903),T={};T.styleTagTransform=w(),T.setAttributes=b(),T.insert=g().bind(null,"head"),T.domAPI=p(),T.insertStyleElement=x();s()(j.A,T);j.A&&j.A.locals&&j.A.locals;const S=(f,e)=>f.filter(f=>f.id.includes(e)).toArray(),A=()=>{var f;return(f=6e5,e=>Math.floor(e/f)*f)((new Date).getTime())/1e3},M=()=>{var f;return(f=6e5,e=>Math.ceil(e/f)*f)((new Date).getTime())/1e3},C=f=>f<10?`0${f}`:`${f}`,N=f=>{const e=new Date(1e3*f);return`${e.getFullYear()}${C(e.getMonth()+1)}${C(e.getDate())}${C(e.getHours())}${C(e.getMinutes())}`},$=(e,t=!0,r=!0)=>{const a=t?i[e]:o[e],n=t?1:2,c=(0,f.jsx)("table",{className:"table-color",children:(0,f.jsx)("tr",{children:a.map(t=>(0,f.jsx)("td",{style:{backgroundColor:t}},`${e}-${t}`))})});return r?(0,f.jsxs)("div",{className:`color-grid color-grid-${n}`,children:[(0,f.jsx)("small",{className:"text-center text-white bg-dark align-self-end rounded",children:"Light"}),c,(0,f.jsx)("small",{className:"text-center text-white bg-dark align-self-end rounded",children:"Heavy"})]}):c};var P=l(37),k=l(761),R={};R.styleTagTransform=w(),R.setAttributes=b(),R.insert=g().bind(null,"head"),R.domAPI=p(),R.insertStyleElement=x();s()(k.A,R);k.A&&k.A.locals&&k.A.locals;var I=l(972);const{useCallback:E,useLayoutEffect:L,useRef:_}=e.React,O=(f,e)=>{if(e){const e=(new Date).getTime()/1e3-f,t=Math.floor(e/60);return t>0?`${t} minutes ago`:`In ${Math.abs(t)} minutes`}return new Date(1e3*f).toLocaleString([],{hour:"numeric",minute:"numeric",hour12:!0})},D=({timePath:e,setTimePath:t,play:r,setPlay:a,timePathList:i,relativeTime:o,playSpeed:c})=>{const s=_(12),l=_(0),d=E(()=>{s.current=s.current===i.length-1?0:s.current+1,t(i[s.current])},[t,i]);return(0,I.useEffect)(()=>{s.current=i.findIndex(f=>f.time===e.time)},[e,i]),L(()=>{let f;const e=()=>{f=setTimeout(()=>{d(),l.current=requestAnimationFrame(e)},1e3/c)};return r?l.current=requestAnimationFrame(e):(clearTimeout(f),cancelAnimationFrame(l.current)),()=>{clearTimeout(f),cancelAnimationFrame(l.current)}},[d,r,c]),(0,f.jsxs)("div",{className:"date-grid",children:[(0,f.jsx)(P.CalciteButton,{title:"Play Pause",iconStart:r?"pause-f":"play-f",round:!0,onClick:()=>{a(!r)},className:"play-button"}),(0,f.jsxs)("div",{className:"text-slide-div",children:[(0,f.jsxs)("div",{className:"text-div",children:[(0,f.jsx)("p",{className:"label-text date-text","aria-label":"Date Text",children:O(e.time,o)}),(0,f.jsx)("p",{className:"label-text now-text",children:"Now"})]}),(0,f.jsx)(n.Slider,{"aria-label":"Time Slider",className:"time-slider",max:i.length-1,min:0,step:1,defaultValue:s.current,value:i.findIndex(f=>f.time===e.time),onChange:f=>{t(i[f.target.valueAsNumber])}})]}),(0,f.jsx)(P.CalciteButton,{title:"Next Time",iconStart:"end-f",round:!0,onClick:()=>{d()},className:"play-button"})]})};var z=function(f,e,t,r){return new(t||(t=Promise))(function(a,n){function i(f){try{c(r.next(f))}catch(f){n(f)}}function o(f){try{c(r.throw(f))}catch(f){n(f)}}function c(f){var e;f.done?a(f.value):(e=f.value,e instanceof t?e:new t(function(f){f(e)})).then(i,o)}c((r=r.apply(f,e||[])).next())})};const{useEffect:F,useRef:V,useState:B,useCallback:U}=e.React,{useSelector:W}=e.ReactRedux,H=i=>{var o;const c=A(),s={time:c,path:`v2/radar/${c}`},{coverageURL:l,colorScheme:d,playOnLoad:u,opacity:p,relativeTime:m,dataSource:g,playSpeed:h}=i.config,[b,v]=B(s),[x,y]=B([s]),[w,j]=B(!0),[T,C]=B(u),[P,k]=B(!1),[R,I]=B(null),[E,L]=B(null),[_,O]=B(null),H=V(null),J=V(s),q=W(f=>f.widgetsRuntimeInfo),Y=U(f=>{const e=`rainfall-radar-base-${f.time}`;const t="1"===g?`https://tilecache.rainviewer.com/${f.path}/256/{z}/{x}/{y}/${d}/1_0.png`:`https://api.weather.bom.gov.au/v1/rainradar/tiles/${f.path}/{z}/{y}/{x}.png`,a="1"===g?'<a href="https://www.rainviewer.com/api.html">Rainviewer</a>':'<a href="http://www.bom.gov.au/">Bureau of Meteorology Australia</a>',n=new r.default({urlTemplate:t,copyright:a,title:`Rainfall Radar for ${e}`,listMode:"hide",visible:!1,opacity:p,id:e});return n.on("layerview-create-error",()=>{n.refresh()}),n},[d,g,p]),G=U(f=>{if(null!==_){const e=Y(f);_.view.map.add(e)}},[Y,_]),K=U(()=>{if(null!==_){const f=S(_.view.map.layers,"rainfall-radar-base-");_.view.map.removeMany(f)}},[_]),Q=U(f=>{if(null!==_){let e=[];const t=S(_.view.map.layers,`${f.time}`);H.current&&H.current.time!==f.time&&(e=S(_.view.map.layers,`${H.current.time}`)),0!==t.length&&(t[0].listMode="show",t[0].visible=!0,0!==e.length&&setTimeout(()=>{e[0].listMode="hide",e[0].visible=!1},80))}},[_]),X=U((f,e=!0)=>{if(null!==_){const t=S(_.view.map.layers,`${f.time}`);0!==t.length&&(t[0].listMode=e?"show":"hide",t[0].visible=!!e)}},[_]);return F(()=>{if(_){const f=(0,e.getAppStore)().getState().appConfig.widgets,[t]=Object.values(f).filter(f=>"widgets/rainfall-radar/"===f.uri),[r]=Object.values(f).filter(f=>"widgets/common/controller/"===f.uri);t&&I(t.id),r&&L(r.id),a.default.whenOnce(()=>_.view.ready).then(()=>{console.log("MapView is ready.")}),k(!0)}},[_]),F(()=>{let f;const e=()=>{"1"===g&&fetch(l).then(f=>z(void 0,void 0,void 0,function*(){return f.json()})).then(f=>{const e=[...f.radar.past,...f.radar.nowcast];y(e),v(f.radar.past[f.radar.past.length-1]),J.current=f.radar.past[f.radar.past.length-1],H.current=f.radar.past[f.radar.past.length-2]}).catch(f=>console.log(f)),"2"===g&&(()=>{let f=A();const e=[];for(let t=0;t<16;t++)e.push({path:N(f),time:f}),f-=600;e.sort((f,e)=>f.time-e.time),y(e),v(e[e.length-1]),J.current=e[e.length-1],H.current=e[e.length-2]})()};if(w){e();let t=M()-(new Date).getTime()/1e3;t=Math.round(1e3*t+6e4),f=setTimeout(()=>{e(),j(!1)},t)}else{f=setInterval(()=>{e()},6e5)}return()=>{clearTimeout(f),clearInterval(f)}},[l,g,w]),F(()=>(x.length>1&&x.forEach(f=>{G(f)}),()=>{K()}),[G,K,x]),F(()=>{const f=q[R];return E&&R&&"OPENED"===f.state&&X(J.current),()=>{X(J.current,!1)}},[E,R,X,q]),F(()=>(J.current=b,Q(b),()=>{H.current=b}),[Q,b]),(0,f.jsxs)("div",{className:"jimu-widget",children:[i.useMapWidgetIds&&1===i.useMapWidgetIds.length&&(0,f.jsx)(t.JimuMapViewComponent,{useMapWidgetId:null===(o=i.useMapWidgetIds)||void 0===o?void 0:o[0],onActiveViewChange:f=>{f&&O(f)}}),(0,f.jsx)("div",{className:"alert-box",children:(0,f.jsx)(n.Alert,{form:"basic",onClose:()=>{},open:!P,text:"Please select a map in settings",type:"info",withIcon:!0})}),null!==_&&(0,f.jsxs)("div",{className:"main-grid",children:[$(d,!0),(0,f.jsx)(D,{timePath:b,setTimePath:v,play:T,setPlay:C,timePathList:x,relativeTime:m,playSpeed:h})]}),null===_&&(0,f.jsx)("div",{children:(0,f.jsx)(n.Loading,{})})]})};function J(f){l.p=f}})(),d})())}}});