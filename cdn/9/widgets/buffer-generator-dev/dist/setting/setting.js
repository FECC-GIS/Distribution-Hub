System.register(["jimu-core/emotion","jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/advanced/data-source-selector"],function(e,l){var t={},o={},n={},a={},i={};return Object.defineProperty(o,"__esModule",{value:!0}),{setters:[function(e){t.jsx=e.jsx,t.jsxs=e.jsxs},function(e){Object.keys(e).forEach(function(l){o[l]=e[l]})},function(e){n.Option=e.Option,n.Select=e.Select,n.Switch=e.Switch,n.TextInput=e.TextInput},function(e){a.MapWidgetSelector=e.MapWidgetSelector,a.SettingRow=e.SettingRow,a.SettingSection=e.SettingSection},function(e){i.DataSourceSelector=e.DataSourceSelector}],execute:function(){e((()=>{var e={244:e=>{"use strict";e.exports=o},298:e=>{"use strict";e.exports=a},321:e=>{"use strict";e.exports=n},386:e=>{"use strict";e.exports=t},470:e=>{"use strict";e.exports=i}},l={};function r(t){var o=l[t];if(void 0!==o)return o.exports;var n=l[t]={exports:{}};return e[t](n,n.exports,r),n.exports}r.d=(e,l)=>{for(var t in l)r.o(l,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:l[t]})},r.o=(e,l)=>Object.prototype.hasOwnProperty.call(e,l),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="";var d={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(d),r.d(d,{__set_webpack_public_path__:()=>p,default:()=>h});var e=r(386),l=r(244),t=r(321),o=r(298),n=r(470),a=function(e,l,t,o){return new(t||(t=Promise))(function(n,a){function i(e){try{d(o.next(e))}catch(e){a(e)}}function r(e){try{d(o.throw(e))}catch(e){a(e)}}function d(e){var l;e.done?n(e.value):(l=e.value,l instanceof t?l:new t(function(e){e(l)})).then(i,r)}d((o=o.apply(e,l||[])).next())})};function i(e){return e?"function"==typeof e.asMutable?e.asMutable({deep:!0}):e:[]}function s(e,l,t){e.onSettingChange({id:e.id,config:e.config.set(l,t)})}function u(e,t,o){var n;const a=(null===(n=e.config)||void 0===n?void 0:n.style)||(0,l.Immutable)({});e.onSettingChange({id:e.id,config:e.config.set("style",a.set(t,o))})}function c(e){const l=Number(e);if(Number.isFinite(l))return l}function g(l){const{label:n,value:a,placeholder:i,disabled:r,onChange:d,onClear:s}=l,u=function(e,l="#000000"){if(!e)return l;const t=e.trim();return function(e){if(!e)return!1;const l=e.trim();return/^#([0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/.test(l)}(t)?t.slice(0,7):l}(a,"#000000"),c=!!a&&a.trim().startsWith("rgba");return(0,e.jsxs)(o.SettingRow,{label:n,flow:"wrap",children:[(0,e.jsxs)("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"44px 1fr auto",gap:8,alignItems:"center"},children:[(0,e.jsx)("input",{type:"color",value:u,disabled:r,onChange:e=>d(e.target.value),style:{width:44,height:32,padding:0,border:"none",background:"transparent"}}),(0,e.jsx)(t.TextInput,{style:{width:"100%"},value:null!=a?a:"",disabled:r,onChange:e=>d(e.target.value),placeholder:i}),(0,e.jsx)("button",{type:"button",onClick:s,disabled:r,style:{padding:"6px 10px",borderRadius:6,border:"1px solid rgba(0,0,0,0.2)",background:"transparent",cursor:r?"default":"pointer"},title:"Clear to let the theme or defaults apply",children:"Clear"})]}),c&&(0,e.jsx)("div",{style:{width:"100%",marginTop:6,fontSize:12,opacity:.8},children:"Tip: The color picker only edits hex values. Keep rgba values for transparency, or click Clear and let the theme handle it."})]})}function h(d){var h,p,v,b,x,f,C,S,y,w,j,m,T,k,I;const R=d.config,B=null==R?void 0:R.style,D=i(d.useDataSources),E=D[0]?[D[0]]:[],M=D.length>1?D.slice(1):[],[F,z]=l.React.useState([]),O=e=>{d.onSettingChange({id:d.id,useDataSourcesEnabled:e})},L=e=>a(this,void 0,void 0,function*(){var l,t,o;try{if(!e)return void z([]);const{DataSourceManager:n}=yield Promise.resolve().then(r.bind(r,244)),a=n.getInstance().getDataSource(e),i=null===(l=null==a?void 0:a.getSchema)||void 0===l?void 0:l.call(a),u=null!==(t=null==i?void 0:i.fields)&&void 0!==t?t:{},c=Object.keys(u).map(e=>{const l=u[e];return{name:e,alias:null==l?void 0:l.alias,type:null==l?void 0:l.type}}).filter(e=>e.name&&"shape"!==e.name.toLowerCase()&&"geometry"!==e.name.toLowerCase()).sort((e,l)=>{const t=(e.type||"").toString().toLowerCase().includes("string")?0:1,o=(l.type||"").toString().toLowerCase().includes("string")?0:1;return t!==o?t-o:e.name.localeCompare(l.name)});z(c);if(!(null===(o=d.config)||void 0===o?void 0:o.vehicleDisplayField)){const e=c.find(e=>(e.type||"").toString().toLowerCase().includes("string"));(null==e?void 0:e.name)&&s(d,"vehicleDisplayField",e.name)}}catch(e){z([])}});l.React.useEffect(()=>{var e;const l=null===(e=null==E?void 0:E[0])||void 0===e?void 0:e.dataSourceId;L(l)},[]);const _=null===(h=null==B?void 0:B.useExperienceTheme)||void 0===h||h,A=_;return(0,e.jsxs)("div",{style:{padding:12},children:[(0,e.jsxs)(o.SettingSection,{title:"Widget",children:[(0,e.jsx)(o.SettingRow,{label:"Widget title",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},value:null!==(p=null==R?void 0:R.widgetTitle)&&void 0!==p?p:"",onChange:e=>{s(d,"widgetTitle",e.target.value)},placeholder:"Leave blank to use the widget name"})}),(0,e.jsx)(o.SettingRow,{label:"Runtime buffer controls",flow:"wrap",children:(0,e.jsxs)("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,e.jsx)("div",{style:{fontSize:12,opacity:.8},children:"Allow end users to change buffer distance and units inside the widget"}),(0,e.jsx)(t.Switch,{checked:null===(v=null==R?void 0:R.enableRuntimeBufferControls)||void 0===v||v,onChange:e=>s(d,"enableRuntimeBufferControls",e.target.checked)})]})})]}),(0,e.jsx)(o.SettingSection,{title:"Map",children:(0,e.jsx)(o.SettingRow,{label:"Map widget",flow:"wrap",children:(0,e.jsx)(o.MapWidgetSelector,{useMapWidgetIds:d.useMapWidgetIds,onSelect:e=>{d.onSettingChange({id:d.id,useMapWidgetIds:(0,l.Immutable)(e)})}})})}),(0,e.jsxs)(o.SettingSection,{title:"Vehicle layer",children:[(0,e.jsxs)("div",{style:{width:"100%"},children:[(0,e.jsx)("div",{style:{fontSize:12,marginBottom:6},children:"Data source"}),(0,e.jsx)(n.DataSourceSelector,{widgetId:d.id,types:(0,l.Immutable)(["FEATURE_LAYER"]),useDataSourceTypes:(0,l.Immutable)(["FEATURE_LAYER"]),useDataSources:(0,l.Immutable)(E),useDataSourcesEnabled:d.useDataSourcesEnabled,onToggleUseDataEnabled:O,onChange:e=>a(this,void 0,void 0,function*(){var t;const o=i(e),n=o[0]?[o[0]]:[],a=[...n,...M];d.onSettingChange({id:d.id,useDataSources:(0,l.Immutable)(a)});const r=null===(t=null==n?void 0:n[0])||void 0===t?void 0:t.dataSourceId;yield L(r)}),mustUseDataSource:!0})]}),(0,e.jsx)(o.SettingRow,{label:"Display field",flow:"wrap",children:(0,e.jsxs)(t.Select,{style:{width:"100%"},value:null!==(b=null==R?void 0:R.vehicleDisplayField)&&void 0!==b?b:"",onChange:e=>{s(d,"vehicleDisplayField",e.target.value)},disabled:0===F.length,children:[(0,e.jsx)(t.Option,{value:"",children:"(auto)"}),F.map(l=>(0,e.jsx)(t.Option,{value:l.name,children:l.alias?`${l.alias} (${l.name})`:l.name},l.name))]})})]}),(0,e.jsxs)(o.SettingSection,{title:"Default buffer",children:[(0,e.jsx)(o.SettingRow,{label:"Distance",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},type:"number",value:(null!==(x=null==R?void 0:R.bufferDistance)&&void 0!==x?x:500).toString(),onChange:e=>{const l=Number(e.target.value);s(d,"bufferDistance",isNaN(l)?0:l)}})}),(0,e.jsx)(o.SettingRow,{label:"Units",flow:"wrap",children:(0,e.jsxs)(t.Select,{style:{width:"100%"},value:null!==(f=null==R?void 0:R.bufferUnit)&&void 0!==f?f:"feet",onChange:e=>{s(d,"bufferUnit",e.target.value)},children:[(0,e.jsx)(t.Option,{value:"feet",children:"Feet"}),(0,e.jsx)(t.Option,{value:"meters",children:"Meters"}),(0,e.jsx)(t.Option,{value:"miles",children:"Miles"}),(0,e.jsx)(t.Option,{value:"kilometers",children:"Kilometers"})]})})]}),(0,e.jsx)(o.SettingSection,{title:"Target layers",children:(0,e.jsxs)("div",{style:{width:"100%"},children:[(0,e.jsx)("div",{style:{fontSize:12,marginBottom:6},children:"Select one or more layers"}),(0,e.jsx)(n.DataSourceSelector,{widgetId:d.id,types:(0,l.Immutable)(["FEATURE_LAYER"]),useDataSourceTypes:(0,l.Immutable)(["FEATURE_LAYER"]),useDataSources:(0,l.Immutable)(M),useDataSourcesEnabled:d.useDataSourcesEnabled,onToggleUseDataEnabled:O,isMultiple:!0,onChange:e=>a(this,void 0,void 0,function*(){const t=i(e),o=[...E,...t],n=t.map(e=>(null==e?void 0:e.label)||(null==e?void 0:e.dataSourceId)).filter(Boolean),s=yield function(e){return a(this,void 0,void 0,function*(){var l,t,o,n;const{DataSourceManager:a}=yield Promise.resolve().then(r.bind(r,244)),i=a.getInstance(),d=[];for(const a of e){const e=null==a?void 0:a.dataSourceId;if(e)try{const a=i.getDataSource(e),r=null===(l=null==a?void 0:a.getDataSourceJson)||void 0===l?void 0:l.call(a),s=null==r?void 0:r.url,u=(null===(t=null==a?void 0:a.layer)||void 0===t?void 0:t.url)||(null===(n=null===(o=null==a?void 0:a.getLayer)||void 0===o?void 0:o.call(a))||void 0===n?void 0:n.url),c=(s||u||"").toString();d.push(c)}catch(e){d.push("")}else d.push("")}return d})}(t);d.onSettingChange({id:d.id,useDataSources:(0,l.Immutable)(o),config:d.config.set("targetLayerTitles",n).set("targetLayerUrls",s)})})})]})}),(0,e.jsxs)(o.SettingSection,{title:"Style",children:[(0,e.jsx)(o.SettingRow,{label:"Use Experience theme",flow:"wrap",children:(0,e.jsxs)("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,e.jsx)("div",{style:{fontSize:12,opacity:.8},children:"When enabled, most colors and fonts inherit from the Experience. Turn off to fully customize."}),(0,e.jsx)(t.Switch,{checked:_,onChange:e=>u(d,"useExperienceTheme",e.target.checked)})]})}),(0,e.jsx)(o.SettingRow,{label:"Font family",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},value:null!==(C=null==B?void 0:B.fontFamily)&&void 0!==C?C:"",disabled:A,onChange:e=>u(d,"fontFamily",e.target.value)})}),(0,e.jsx)(o.SettingRow,{label:"Base font size (px)",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},type:"number",value:String(null!==(S=null==B?void 0:B.baseFontSize)&&void 0!==S?S:13),disabled:A,onChange:e=>u(d,"baseFontSize",c(e.target.value))})}),(0,e.jsx)(o.SettingRow,{label:"Title font size (px)",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},type:"number",value:String(null!==(y=null==B?void 0:B.titleFontSize)&&void 0!==y?y:15),disabled:A,onChange:e=>u(d,"titleFontSize",c(e.target.value))})}),(0,e.jsx)(o.SettingRow,{label:"Small font size (px)",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},type:"number",value:String(null!==(w=null==B?void 0:B.smallFontSize)&&void 0!==w?w:12),disabled:A,onChange:e=>u(d,"smallFontSize",c(e.target.value))})}),(0,e.jsx)(o.SettingRow,{label:"Border width (px)",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},type:"number",value:String(null!==(j=null==B?void 0:B.borderWidth)&&void 0!==j?j:1),disabled:A,onChange:e=>u(d,"borderWidth",c(e.target.value))})}),(0,e.jsx)(o.SettingRow,{label:"Border radius (px)",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},type:"number",value:String(null!==(m=null==B?void 0:B.borderRadius)&&void 0!==m?m:8),disabled:A,onChange:e=>u(d,"borderRadius",c(e.target.value))})}),(0,e.jsx)(o.SettingRow,{label:"Padding (px)",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},type:"number",value:String(null!==(T=null==B?void 0:B.padding)&&void 0!==T?T:12),disabled:A,onChange:e=>u(d,"padding",c(e.target.value))})}),(0,e.jsx)(o.SettingRow,{label:"Gap (px)",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},type:"number",value:String(null!==(k=null==B?void 0:B.gap)&&void 0!==k?k:10),disabled:A,onChange:e=>u(d,"gap",c(e.target.value))})}),(0,e.jsx)(o.SettingRow,{label:"List max height (px)",flow:"wrap",children:(0,e.jsx)(t.TextInput,{style:{width:"100%"},type:"number",value:String(null!==(I=null==B?void 0:B.listMaxHeight)&&void 0!==I?I:260),disabled:A,onChange:e=>u(d,"listMaxHeight",c(e.target.value))})}),(0,e.jsx)(g,{label:"Background color",value:null==B?void 0:B.backgroundColor,placeholder:"#0b1220",disabled:A,onChange:e=>u(d,"backgroundColor",e),onClear:()=>u(d,"backgroundColor","")}),(0,e.jsx)(g,{label:"Panel background color",value:null==B?void 0:B.panelBackgroundColor,placeholder:"#0f172a",disabled:A,onChange:e=>u(d,"panelBackgroundColor",e),onClear:()=>u(d,"panelBackgroundColor","")}),(0,e.jsx)(g,{label:"Text color",value:null==B?void 0:B.textColor,placeholder:"#e5e7eb",disabled:A,onChange:e=>u(d,"textColor",e),onClear:()=>u(d,"textColor","")}),(0,e.jsx)(g,{label:"Subtle text color",value:null==B?void 0:B.subtleTextColor,placeholder:"rgba(229,231,235,0.75)",disabled:A,onChange:e=>u(d,"subtleTextColor",e),onClear:()=>u(d,"subtleTextColor","")}),(0,e.jsx)(g,{label:"Border color",value:null==B?void 0:B.borderColor,placeholder:"rgba(255,255,255,0.14)",disabled:A,onChange:e=>u(d,"borderColor",e),onClear:()=>u(d,"borderColor","")}),(0,e.jsx)(g,{label:"Accent color",value:null==B?void 0:B.accentColor,placeholder:"#60a5fa",disabled:A,onChange:e=>u(d,"accentColor",e),onClear:()=>u(d,"accentColor","")}),(0,e.jsx)(g,{label:"Link color",value:null==B?void 0:B.linkColor,placeholder:"#60a5fa",disabled:A,onChange:e=>u(d,"linkColor",e),onClear:()=>u(d,"linkColor","")}),(0,e.jsx)(o.SettingRow,{label:"Button",flow:"wrap",children:(0,e.jsx)("div",{style:{width:"100%",display:"grid",gap:8},children:(0,e.jsx)("div",{style:{fontSize:12,opacity:.8},children:"These control Apply, Reset, and Close buttons."})})}),(0,e.jsx)(g,{label:"Button background",value:null==B?void 0:B.buttonBackgroundColor,placeholder:"#111827",disabled:A,onChange:e=>u(d,"buttonBackgroundColor",e),onClear:()=>u(d,"buttonBackgroundColor","")}),(0,e.jsx)(g,{label:"Button text",value:null==B?void 0:B.buttonTextColor,placeholder:"#e5e7eb",disabled:A,onChange:e=>u(d,"buttonTextColor",e),onClear:()=>u(d,"buttonTextColor","")}),(0,e.jsx)(g,{label:"Button border",value:null==B?void 0:B.buttonBorderColor,placeholder:"rgba(255,255,255,0.14)",disabled:A,onChange:e=>u(d,"buttonBorderColor",e),onClear:()=>u(d,"buttonBorderColor","")}),(0,e.jsx)(o.SettingRow,{label:"Inputs",flow:"wrap",children:(0,e.jsx)("div",{style:{width:"100%",display:"grid",gap:8},children:(0,e.jsx)("div",{style:{fontSize:12,opacity:.8},children:"These control the distance and unit controls inside the widget."})})}),(0,e.jsx)(g,{label:"Input background",value:null==B?void 0:B.inputBackgroundColor,placeholder:"#0b1220",disabled:A,onChange:e=>u(d,"inputBackgroundColor",e),onClear:()=>u(d,"inputBackgroundColor","")}),(0,e.jsx)(g,{label:"Input text",value:null==B?void 0:B.inputTextColor,placeholder:"#e5e7eb",disabled:A,onChange:e=>u(d,"inputTextColor",e),onClear:()=>u(d,"inputTextColor","")}),(0,e.jsx)(g,{label:"Input border",value:null==B?void 0:B.inputBorderColor,placeholder:"rgba(255,255,255,0.14)",disabled:A,onChange:e=>u(d,"inputBorderColor",e),onClear:()=>u(d,"inputBorderColor","")}),(0,e.jsx)(o.SettingRow,{label:"Modal",flow:"wrap",children:(0,e.jsx)("div",{style:{width:"100%",display:"grid",gap:8},children:(0,e.jsx)("div",{style:{fontSize:12,opacity:.8},children:"The modal shows the buffer results and feature details."})})}),(0,e.jsx)(g,{label:"Modal overlay",value:null==B?void 0:B.modalOverlayColor,placeholder:"rgba(0,0,0,0.45)",disabled:A,onChange:e=>u(d,"modalOverlayColor",e),onClear:()=>u(d,"modalOverlayColor","")}),(0,e.jsx)(g,{label:"Modal background",value:null==B?void 0:B.modalBackgroundColor,placeholder:"#ffffff",disabled:A,onChange:e=>u(d,"modalBackgroundColor",e),onClear:()=>u(d,"modalBackgroundColor","")}),(0,e.jsx)(o.SettingRow,{label:"Debug panel",flow:"wrap",children:(0,e.jsx)("div",{style:{width:"100%",display:"grid",gap:8},children:(0,e.jsx)("div",{style:{fontSize:12,opacity:.8},children:"Shown when Debug is expanded inside the modal."})})}),(0,e.jsx)(g,{label:"Debug background",value:null==B?void 0:B.debugBackgroundColor,placeholder:"rgba(255,255,255,0.06)",disabled:A,onChange:e=>u(d,"debugBackgroundColor",e),onClear:()=>u(d,"debugBackgroundColor","")}),(0,e.jsx)(o.SettingRow,{label:"Header",flow:"wrap",children:(0,e.jsx)("div",{style:{width:"100%",display:"grid",gap:8},children:(0,e.jsx)("div",{style:{fontSize:12,opacity:.8},children:"Optional, use if you add a header block later."})})}),(0,e.jsx)(g,{label:"Header background",value:null==B?void 0:B.headerBackgroundColor,placeholder:"",disabled:A,onChange:e=>u(d,"headerBackgroundColor",e),onClear:()=>u(d,"headerBackgroundColor","")}),(0,e.jsx)(g,{label:"Header text",value:null==B?void 0:B.headerTextColor,placeholder:"",disabled:A,onChange:e=>u(d,"headerTextColor",e),onClear:()=>u(d,"headerTextColor","")})]})]})}function p(e){r.p=e}})(),d})())}}});